!function(){"use strict";function a(a,e){var o=a.innerWidth(),t=a.innerHeight(),n=e.outerWidth()/o;e.outerHeight()/t;if(null==n||null==o)return alert("Eita, deu erro. :("),S++,!1;if(s&&(console.log("winW: "+o),console.log("wRatio: "+n),console.log("outerWidth: "+e.outerWidth()),console.log("outerHeight: "+e.outerHeight())),n<=1){for(;e.outerWidth()<o;)s&&console.log("outerWidth < winW"),x++,a.css("font-size",x+"px"),e.css("font-size",x+"px");for(;e.outerHeight()>t;)s&&console.log("outerHeight > winH"),x--,a.css("font-size",x+"px"),e.css("font-size",x+"px")}else{for(;e.outerWidth()>o;)s&&console.log("fntSz--(1)"),x--,a.css("font-size",x+"px"),e.css("font-size",x+"px");for(;e.outerHeight()>t;)s&&console.log("fntSz--(2)"),x--,a.css("font-size",x+"px"),e.css("font-size",x+"px")}return e.css("top",(t-e.outerHeight())/2),e.css("left",(o-e.outerWidth())/2),s&&console.log("FIM SCALE"),!0}function e(){$("#bloco").removeClass(),$("#bloco").addClass(u).addClass(f).addClass(m).addClass(p).addClass(h).addClass(b)}function o(a,e){a.text($("label."+e).text()).removeClass().addClass(e).addClass("escolhido")}function t(a,e){a.removeClass(),a.addClass(e)}function n(a){$("#descricao_imagem_fb").val(),$("#objetos_compartilha").slideUp(),1==a&&$("#comentario").slideUp()}function r(a,e,o,t,n){null!=n?e.removeClass().text(a).addClass(o).slideDown(200,n()):(e.removeClass().text(a).addClass(o).slideDown(),t>0&&e.delay(t).slideUp())}var s=!1,i=!1,c=!0,l={fonte:"oswald",forca:"forca_normal",escrita:"escrita_maiuscula",sombra:"",background:"none",formato:"form_quadrado",borda:"borda_sem"};s&&(l={fonte:"oswald",forca:"forca_normal",escrita:"escrita_maiuscula",sombra:"sombra",background:"none",formato:"form_quadrado",borda:"borda_sem"});var d={stringToBinaryArray:function(a){return Array.prototype.map.call(a,function(a){return 255&a.charCodeAt(0)})},base64ToString:function(a){return atob(a)}},m=l.fonte,f=l.forca,u=l.escrita,p=l.sombra,g="inverte",h=l.background,b=l.formato,_=l.borda,v="",x=120,k=180,C=$("#contador"),y=$("<span/>").append($("<em/>").text("Carregando...")).css("display","none"),S=0;$("#imagem_final").attr("src",""),e(),$("#bloco").append(y),$("#"+m).attr("checked","checked"),$("#"+f).attr("checked","checked"),$("#"+u).attr("checked","checked"),C.text("0/"+k),$("#btn_gera_imagem").on("click",function(){var e=$("#bloco"),o=$("#bloco a"),t=$("#onde"),r=$("#texto");if(""!=r.val()){e.css("display","table-cell"),n(!0),t.text("");var c=r.val();c=c.replace(/\n/g,"<br/>"),c=c.replace(/' '/g,"&nbsp;"),c=c.replace(/-----/g,"<hr/>");var l=c.indexOf("#"),d=c.lastIndexOf("#");if(l!=d){var m=c.substring(0,l);m+='<span class="'+g+'">',m+=c.substring(l+1,d),m+="</span>",m+=c.substring(d+1,c.length),c=m}c=c.replace(/<3/g,"&#9829;"),c=c.replace(/<\/3/g,"&#128148;").replace(/<,3/g,"&#128148;"),c=c.replace(/:\)/g,"&#9786;"),c=c.replace(/:\(/g,"&#9785;"),t.html(c),y.fadeIn(),a(o,t)&&(i||html2canvas(e,{background:"#fff",logging:s,onrendered:function(a){v=a.toDataURL("image/png",.9),$("#imagem_final").attr("src",v),s||$("#imagem_final").css("display","block"),$("#comentario").fadeIn()}})),y.fadeOut(),s||e.css("display","none"),s||console.log("Posição imagem: "+$("#ponto_imagem").offset().top),$("html, body").animate({scrollTop:$("#ponto_imagem").offset().top},500)}}),$("input").on("click",function(){$("#onde").text(""),"fonte"==$(this).attr("name")&&(m=$(this).val(),e(),o($("#fonte_escolhida"),m)),"forca"==$(this).attr("name")&&(f=$(this).val(),e(),o($("#forca_escolhida"),f)),"escrita"==$(this).attr("name")&&(u=$(this).val(),e(),o($("#escrita_escolhida"),u)),"background"==$(this).attr("name")&&(h=$(this).val(),e(),o($("#fundo_escolhida"),h)),"formato"==$(this).attr("name")&&(b=$(this).val(),$("#imagem_final").removeClass().addClass(b),e(),o($("#formato_escolhida"),b)),"borda"==$(this).attr("name")&&(_=$(this).val(),t($("#bloco a"),_),o($("#borda_escolhida"),_),"borda_com"==_?(t($("#marca"),"space_mono marca_com_borda"),$("#informa_borda").fadeIn().delay(8e3).slideUp()):t($("#marca"),"space_mono marca_sem_borda")),"exibe_marca"==$(this).attr("name")&&($(this).prop("checked")?$("#marca").hide():$("#marca").show())}),$("textarea").on("input",function(){var a=$(this).val();a.length>k?(a=a.slice(0,k),$(this).val(a),C.text("Sem textão!!").fadeOut(2e3,function(){C.text(a.length+"/"+k)}).fadeIn()):C.text(a.length+"/"+k)});var w=!1;$("#det_coisas_legais").on("click",function(){w?($("#coisas_legais").slideUp(),$(this).text("Ah, olha o que da pra fazer de legal!")):($("#coisas_legais").slideDown(),$(this).text("Bacana né? [clique aqui para esconder]")),w=!w}),$(".opc").on("click",function(){var a=$(this).attr("id");"none"==$("."+a).css("display")?$("."+a).slideDown():$("."+a).slideUp()}),function(){var a="img/",e=2,o=0;for(o=1;o<=e;o++)$(".img_ex"+o).attr("src",a+"ex"+o+".jpg")}(),$("#inicia_compartilhar_facebook").on("click",function(){$("#objetos_compartilha").slideDown()}),$.ajaxSetup({cache:!0}),$.getScript("//connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:"1241288265961400",version:"v2.8"}),$("#loginbutton,#feedbutton").removeAttr("disabled")}),$("#envia_imagem_facebook").on("click",function(){var a=$("#informa_compartilha"),e=$("#informa_msg");FB.login(function(o){o.authResponse?(c&&console.log("Logado. Pegando informações"),FB.api("/me",function(o){o.name;c&&(console.log(o),console.log("Olá, "+o.name+"."));var t=FB.getAuthResponse();if(null!=t){var s=function(){if(t.grantedScopes.search(/publish_actions/)!=-1){var e=v.replace(/^data:image\/(png|jpe?g);base64,/,""),o=d.base64ToString(e),s="";$("#descricao_imagem_fb")&&(s=$("#descricao_imagem_fb").val());var i={url:"https://graph.facebook.com/me/photos",type:"POST",cache:!1,success:function(a){c&&console.log(a)},error:function(a){c&&console.error(a)},processData:!1,xhr:function(){var a=$.ajaxSettings.xhr();return a.send=function(a){var e=d.stringToBinaryArray(a);XMLHttpRequest.prototype.send.call(this,new Uint8Array(e).buffer)},a}},l=function(a,e){var o="";return $.each(a,function(a,t){o+="--"+e+"\r\n",t.dataString?(o+="Content-Disposition: form-data; name='"+a+"'; filename='"+t.name+"'\r\n",o+="Content-Type: "+t.type+"\r\n\r\n",o+=t.dataString+"\r\n"):(o+="Content-Disposition: form-data; name='"+a+"';\r\n\r\n",o+=t+"\r\n")}),o+="--"+e+"--"},m=function(a,e){var o="separator de campo "+Math.random();a.data=l(e.fb,o),a.contentType="multipart/form-data; boundary="+o},f=function(a){var e=$.extend({},i,a.call);e.url+="?access_token="+a.fb.accessToken,m(e,a),$.ajax(e)};f({fb:{caption:s,accessToken:FB.getAccessToken(),file:{name:"sua_mensagem.png",type:"image/png",dataString:o}},call:{url:"https://graph.facebook.com/me/photos",success:function(e){r("Imagem compartilhada!!",a,"informa",8e3),n(!1),c&&console.log(e)},error:function(e){r("Ocorreu um erro ao compartilhar. :( Se estiver no celular, clique e segure na imagem para compartilhar diretamente pelo celular.",a,"informa_erro",15e3),c&&console.log(e)}}})}else r("Você não autorizou o Sua Mensagem a postar no seu perfil. Se desejar, clique novamente em Compartilhar Imagem.",a,"informa_atencao",12e3)};r("Enviando imagem para o Facebook. Aguarde, por favor.",e,"informa_msg",0,s)}else r("Você não autorizou o Sua Mensagem a postar no seu perfil. Se desejar, clique novamente em Compartilhar Imagem.",a,"informa_atencao",12e3)})):r("Você não está logado no Facebook. Se desejar, clique novamente em Compartilhar Imagem.",a,"informa_atencao",12e3)},{scope:"publish_actions",return_scopes:!0})})}(self);